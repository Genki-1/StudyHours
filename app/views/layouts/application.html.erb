<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>StudyHours</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= include_gon %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg justify-content-end mb-3 p-3" style="background-color:#9be3de">
      <div class="navbar-left">          
      </div>
      <div class="navbar-right">
        <ul class="nav navbar-nav">
          <li class="nav-item">
          <% if user_signed_in? %>
          <li class="nav-item">
            <%= link_to timelines_path,class: "nav-link" do%>
              <i class="fas fa-home"> マイページ</i>
            <% end %>
            </li>
            <li>
              <%= link_to searchs_path ,class: "nav-link" do %>
                <i class="fas fa-search"> 探す</i>
              <% end %>
            </li>

            <li class="nav-item">
              <div class= "nav-link study-modal-button">
                <i class="fas fa-sign-in-alt">学習記録を書く</i>                
              </div>
            </li>
            <li class="nav-item">
              <div class= "nav-link note-modal-button">
                <i class="fas fa-book"> ノートを書く</i>
              </div>
            </li>
            <li class="nav-item">
              <%= link_to rooms_path ,class: "nav-link" do %>
                <i class="fas fa-comment-dots"> チャットする</i>
              <% end %>
            </li>

            <li class="nav-item">
              <%= link_to destroy_user_session_path,method: :delete,class: "nav-link" do %>
                <i class="fas fa-sign-out-alt"> ログアウト</i>
              <% end %>
            </li>

            <% else %>
            <li class="nav-item">
              <%= link_to new_user_registration_path,class: "nav-link" do %>
                <i class="fas fa-edit"> 会員登録</i>
              <% end %>
            </li>
            <li class="nav-item">
              <%= link_to new_user_session_path,class: "nav-link"  do %>
                <i class="fas fa-sign-in-alt"> ログイン</i>
              <% end %>
            </li>
            <% end %>
          </ul>
        </div>
      </nav>
      <%= render 'layouts/flash_messages' %>
    </div>     
  </div>
</div>
    <%= yield %>

<% if user_signed_in? %>
  <div class="study-modal-wrapper">
    <div class="study-modal">
        <%= render 'study_logs/modal_new',study_log: current_user.study_logs.new%>    
    </div>
  </div>

  <div class="note-modal-wrapper">
    <div class="note-modal">
        <%= render 'notes/modal_new',note: current_user.notes.new%>    
    </div>
  </div>

<% end %>
<script>
  $(document).on('turbolinks:load', function () {
    $('.study-modal-button').on('click',function(){
        $('.study-modal-wrapper').fadeIn();
        $('.study-modal').fadeIn();
        $('body').css('overflow','hidden');
        $(function(){
          $('.study-modal-wrapper').on('click',function(){
            $('body').css('overflow','');
            $(this).fadeOut();
          });
          $('.study-log-new-width').on('click',function(e){
            e.stopPropagation();
          });
        });
    });
  });

  $(document).on('turbolinks:load', function () {
    $('.note-modal-button').on('click',function(){
        $('.note-modal-wrapper').fadeIn();
        $('.note-modal').fadeIn();
        $('body').css('overflow','hidden');

        $(function(){
          $('.note-modal-wrapper').on('click',function(){
            $('body').css('overflow','');
            $(this).fadeOut();
          });
          $('.note-modal-bg').on('click',function(e){
            e.stopPropagation();
          });
        });
    });
  });
</script>
</body>
</html>
